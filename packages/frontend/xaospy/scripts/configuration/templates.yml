# =================================================================================================
# CONFIGURATION TEMPLATES FILE: templates.yml
#
# PURPOSE:
#   - Defines Jinja2 templates for generating device configurations in the template_workflow script.
#   - Specifies template metadata (id, name, category, description) and parameters for rendering in
#     UniversalTemplateForm.jsx and DeviceConfigurationRunner.jsx.
#   - Supports dynamic options for select fields via dynamicOptionsEndpoint, compatible with ModernDropdown.jsx.
#   - Organizes templates by category for display in the TemplateAccordionMenu sidebar.
#
# OVERVIEW:
#   This file contains templates for Juniper device configurations (e.g., interfaces, BGP, OSPF).
#   Each template includes parameters with types (text, number, select, enum), validation rules,
#   and optional dynamic options fetched from API endpoints. The templates are fetched via the
#   /api/templates/list endpoint and displayed in a categorized sidebar.
#
# KEY FEATURES:
#   - Template Organization: Groups templates by category (e.g., Interface, Routing) for sidebar display.
#   - Parameter Types: Supports text, number, select, and enum with validation (regex, min/max).
#   - Dynamic Options: Uses dynamicOptionsEndpoint for fetching options (e.g., interfaces, policies).
#   - Validation: Includes regex patterns and min/max constraints for robust input validation.
#   - Compatibility: Aligns with UniversalTemplateForm.jsx and ModernDropdown.jsx for UI rendering.
#
# HOW-TO GUIDE (INTEGRATION):
#   - Place in the appropriate directory (e.g., python_pipeline/tools/configuration/templates.yml).
#   - Ensure backend API (http://localhost:3001) supports dynamicOptionsEndpoint (e.g., /api/interfaces).
#   - Verify template_file paths (e.g., interface.j2, bgp.j2) exist in the backend template directory.
#   - Test with DeviceConfigurationRunner.jsx:
#     - Navigate to Configuration Templates in the UI.
#     - Verify templates appear in the sidebar under their categories.
#     - Check that parameters (including select/enum) render correctly in UniversalTemplateForm.jsx.
#     - Test dynamic options by selecting templates with dynamicOptionsEndpoint.
#   - Update parameters as needed to support additional template types or validation rules.
#
# DEPENDENCIES:
#   - Backend API: Must support /api/templates/list and dynamicOptionsEndpoint routes.
#   - Jinja2 Templates: Referenced template_file (e.g., interface.j2) must exist.
#   - UI Components: DeviceConfigurationRunner.jsx, UniversalTemplateForm.jsx, ModernDropdown.jsx.
#
# =================================================================================================

templates:
  # -------------------------------------------------------------------------------------------------
  # TEMPLATE: Interface Configuration
  # -------------------------------------------------------------------------------------------------
  - id: "interface_config"
    name: "Interface Configuration"
    description: "Configure physical and logical interfaces on Juniper devices."
    category: "Interface"
    template_file: "interface.j2"
    parameters:
      - name: "interface_name"
        label: "Interface Name"
        type: "text"
        required: true
        #dynamicOptionsEndpoint: "/api/interfaces"
        description: "Select the physical or logical interface to configure."
      - name: "description"
        label: "Description"
        type: "text"
        required: false
        placeholder: "e.g., Link to Router A"
        description: "Optional description for the interface."
      - name: "ip_address"
        label: "IP Address"
        type: "text"
        required: true
        placeholder: "e.g., 192.168.1.1/24"
        validation: "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}/[0-9]{1,2}$"
        description: "The IP address and subnet mask (e.g., 192.168.1.1/24)."
      - name: "vlan_id"
        label: "VLAN ID"
        type: "number"
        required: false
        min: 1
        max: 4094
        description: "Optional VLAN ID for the interface (1-4094)."
      - name: "mtu"
        label: "MTU"
        type: "number"
        required: false
        default: 1500
        min: 68
        max: 9192
        description: "Maximum Transmission Unit (68-9192 bytes)."
      - name: "interface_mode"
        label: "Interface Mode"
        type: "enum"
        required: false
        options:
          - { value: "access", label: "Access Mode" }
          - { value: "trunk", label: "Trunk Mode" }
        description: "Select the interface mode (access or trunk)."

  # -------------------------------------------------------------------------------------------------
  # TEMPLATE: BGP Configuration
  # -------------------------------------------------------------------------------------------------
  - id: "bgp_config"
    name: "BGP Configuration"
    description: "Configure BGP routing protocol on Juniper devices."
    category: "Routing"
    template_file: "bgp.j2"
    parameters:
      - name: "local_as"
        label: "Local AS Number"
        type: "number"
        required: true
        placeholder: "e.g., 65001"
        min: 1
        max: 4294967295
        description: "The local Autonomous System number (1-4294967295)."
      - name: "router_id"
        label: "Router ID"
        type: "text"
        required: true
        placeholder: "e.g., 1.1.1.1"
        validation: "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$"
        description: "The BGP router ID in IPv4 format."
      - name: "neighbor_ip"
        label: "Neighbor IP"
        type: "text"
        required: true
        placeholder: "e.g., 192.168.1.2"
        validation: "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$"
        description: "The IP address of the BGP neighbor."
      - name: "neighbor_as"
        label: "Neighbor AS"
        type: "number"
        required: true
        placeholder: "e.g., 65002"
        min: 1
        max: 4294967295
        description: "The neighbor's Autonomous System number."
      - name: "policy_import"
        label: "Import Policy"
        type: "select"
        required: false
        dynamicOptionsEndpoint: "/api/policies/import"
        description: "Select an import policy for BGP (optional)."
      - name: "policy_export"
        label: "Export Policy"
        type: "select"
        required: false
        dynamicOptionsEndpoint: "/api/policies/export"
        description: "Select an export policy for BGP (optional)."

  # -------------------------------------------------------------------------------------------------
  # TEMPLATE: OSPF Configuration
  # -------------------------------------------------------------------------------------------------
  - id: "ospf_config"
    name: "OSPF Configuration"
    description: "Configure OSPF routing protocol on Juniper devices."
    category: "Routing"
    template_file: "ospf.j2"
    parameters:
      - name: "area_id"
        label: "Area ID"
        type: "text"
        required: true
        placeholder: "e.g., 0.0.0.0"
        validation: "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$"
        description: "The OSPF area ID in dotted-decimal format."
      - name: "router_id"
        label: "Router ID"
        type: "text"
        required: true
        placeholder: "e.g., 1.1.1.1"
        validation: "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$"
        description: "The OSPF router ID in IPv4 format."
      - name: "interface_name"
        label: "Interface Name"
        type: "select"
        required: true
        dynamicOptionsEndpoint: "/api/interfaces"
        description: "Select the interface to enable OSPF."
      - name: "hello_interval"
        label: "Hello Interval (seconds)"
        type: "number"
        required: false
        default: 10
        min: 1
        max: 65535
        description: "Time between OSPF hello packets (1-65535 seconds)."
      - name: "dead_interval"
        label: "Dead Interval (seconds)"
        type: "number"
        required: false
        default: 40
        min: 1
        max: 65535
        description: "Time to declare a neighbor down (1-65535 seconds)."
      - name: "metric"
        label: "Interface Metric"
        type: "number"
        required: false
        default: 1
        min: 1
        max: 65535
        description: "OSPF metric for the interface (1-65535)."
      - name: "area_type"
        label: "Area Type"
        type: "enum"
        required: false
        options:
          - { value: "stub", label: "Stub Area" }
          - { value: "nssa", label: "Not-So-Stubby Area" }
          - { value: "backbone", label: "Backbone Area" }
        description: "Select the OSPF area type (optional)."
